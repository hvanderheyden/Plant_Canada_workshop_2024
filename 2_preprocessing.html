<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Cleaning taxonomy</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Biovigilance of Phytopathogens Based on a Metabarcoding Approach</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="setup_requirements.html">Workshop Requirements</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Part I: Data cleaning and filtering
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="1_import_data.html">Importing data into R</a>
    </li>
    <li>
      <a href="2_preprocessing.html">Data cleaning</a>
    </li>
    <li>
      <a href="3_summaries.html">Data filtering</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Part II -- Comparing sequencing techniques
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="4_stacked_barchart.html">stacked bar charts</a>
    </li>
    <li>
      <a href="5_comparison.html">Comparisons</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Supplementary material
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="6_Heat_map.html">Diversity</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/hvanderheyden/Plant_Canada_2024_workshop.github.io">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Cleaning taxonomy</h1>

</div>


<p>The next step toward analyzing our data is to get them clean. So lets
load our phyloseq object</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>combinedPS_clean<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">&quot;Processed_data/combinedPS_final.rds&quot;</span>)</span></code></pre></div>
<p>and needed packages</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;phyloseq&quot;</span>)</span></code></pre></div>
<div id="clean-taxonomy" class="section level2">
<h2>Clean taxonomy</h2>
<p>The first step in our cleaning process will be to remove the prefixes
that appear in front of each taxon (e.g. k__, s__, etc.).</p>
<p>To get there, we need to extract the tax table from our Phyloseq
object, transformed it into a data frame (taxM) and generate a clean
version the taxonomy table, as a new dataframe (taxM.clean).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>taxM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(phyloseq<span class="sc">::</span><span class="fu">tax_table</span>(combinedPS_clean))</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>tax.cleanM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">row.names =</span> <span class="fu">row.names</span>(taxM),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                         <span class="at">Kingdom =</span> <span class="fu">str_replace</span>(taxM[,<span class="dv">1</span>], <span class="st">&quot;k__&quot;</span>,<span class="st">&quot;&quot;</span>),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                         <span class="at">Phylum =</span> <span class="fu">str_replace</span>(taxM[,<span class="dv">2</span>], <span class="st">&quot;p__&quot;</span>,<span class="st">&quot;&quot;</span>),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                         <span class="at">Class =</span> <span class="fu">str_replace</span>(taxM[,<span class="dv">3</span>], <span class="st">&quot;c__&quot;</span>,<span class="st">&quot;&quot;</span>),</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                         <span class="at">Order =</span> <span class="fu">str_replace</span>(taxM[,<span class="dv">4</span>], <span class="st">&quot;o__&quot;</span>,<span class="st">&quot;&quot;</span>),</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                         <span class="at">Family =</span> <span class="fu">str_replace</span>(taxM[,<span class="dv">5</span>], <span class="st">&quot;f__&quot;</span>,<span class="st">&quot;&quot;</span>),</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                         <span class="at">Genus =</span> <span class="fu">str_replace</span>(taxM[,<span class="dv">6</span>], <span class="st">&quot;g__&quot;</span>,<span class="st">&quot;&quot;</span>),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                         <span class="at">Species =</span> <span class="fu">str_replace</span>(taxM[,<span class="dv">7</span>], <span class="st">&quot;s__&quot;</span>,<span class="st">&quot;&quot;</span>),</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>                         <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>){ tax.cleanM[,i] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tax.cleanM[,i])}</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>tax.cleanM<span class="ot">&lt;-</span>tax.cleanM <span class="sc">%&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;_&quot;</span>, <span class="st">&quot; &quot;</span>))</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="fu">head</span>(tax.cleanM[,<span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>])</span></code></pre></div>
<pre><code>##                                              Family       Genus
## OM809222.1                            Clitocybaceae Singerocybe
## AY340012.1                         Hymenochaetaceae   Phellinus
## MH856479.1                          Psathyrellaceae Coprinopsis
## MT611529.1                               Irpicaceae     Efibula
## cdfa0cc0a1ccbc5309f6166a35e728a4    Peronosporaceae Peronospora
## EU070924.1                       Bulleribasidiaceae   Dioszegia
##                                                      Species
## OM809222.1                       Singerocybe adirondackensis
## AY340012.1                                Phellinus hartigii
## MH856479.1                            Coprinopsis cothurnata
## MT611529.1                               Efibula yunnanensis
## cdfa0cc0a1ccbc5309f6166a35e728a4      Peronospora manshurica
## EU070924.1                               Dioszegia butyracea</code></pre>
</div>
<div id="species-clusters" class="section level2">
<h2>Species clusters</h2>
<p>As ITS do not allow precise identification of certain species
(oomycetes in this case, but also fungi), it is necessary to group
certain species into species clusters. This gives us greater confidence
in our identification. (See for example <a
href="https://onlinelibrary.wiley.com/doi/10.1002/edn3.529">Van der
Heyden et al. 2024</a>)</p>
<p>So let’s continue to modify our tax.cleanM dataframe to replace some
of the species of our taxonomy tables with species clusters.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>tax.cleanM<span class="ot">&lt;-</span>tax.cleanM <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># P. cactorum cluster (calde 1a) </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora cactorum&quot;</span>, <span class="st">&quot;Phytophthora cactorum cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora idaei&quot;</span>, <span class="st">&quot;Phytophthora cactorum cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora alpina&quot;</span>, <span class="st">&quot;Phytophthora cactorum cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora pseudotsugae&quot;</span>, <span class="st">&quot;Phytophthora cactorum cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora aleatoria&quot;</span>, <span class="st">&quot;Phytophthora cactorum cluster&quot;</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="co"># P. citricola complex (clade 2c)</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora citricola&quot;</span>, <span class="st">&quot;Phytophthora citricola complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora acerina&quot;</span>, <span class="st">&quot;Phytophthora citricola complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora plurivora&quot;</span>, <span class="st">&quot;Phytophthora citricola complex&quot;</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="co"># P. nemorosa cluster (clade 3a)</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora nemorosa&quot;</span>, <span class="st">&quot;Phytophthora nemorosa cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora ilicis&quot;</span>, <span class="st">&quot;Phytophthora nemorosa cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora pseudosyringae&quot;</span>, <span class="st">&quot;Phytophthora nemorosa cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora pluvialis&quot;</span>, <span class="st">&quot;Phytophthora nemorosa cluster&quot;</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>  <span class="co"># P. cooljarloo cluster (clade 6a)</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora aquae-cooljarloo&quot;</span>, <span class="st">&quot;Phytophthora cooljarloo cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora rosacearum&quot;</span>, <span class="st">&quot;Phytophthora cooljarloo cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora kwongonina&quot;</span>, <span class="st">&quot;Phytophthora cooljarloo cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora pseudorosacearum&quot;</span>, <span class="st">&quot;Phytophthora cooljarloo cluster&quot;</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>  <span class="co"># P. inundata cluster (clade 6a)</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora inundata&quot;</span>, <span class="st">&quot;Phytophthora inundata cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora humicola&quot;</span>, <span class="st">&quot;Phytophthora inundata cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora condilina&quot;</span>, <span class="st">&quot;Phytophthora inundata cluster&quot;</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>  <span class="co"># P. chlamydospora cluster (clade 6b)</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora chlamydospora&quot;</span>, <span class="st">&quot;Phytophthora chlamydospora cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora borealis&quot;</span>, <span class="st">&quot;Phytophthora chlamydospora cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora mississippiae&quot;</span>, <span class="st">&quot;Phytophthora chlamydospora cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora gonapodyides&quot;</span>, <span class="st">&quot;Phytophthora chlamydospora cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="co"># P. megasperma cluster (clade 6b)</span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora megasperma&quot;</span>, <span class="st">&quot;Phytophthora megasperma cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora crassamura&quot;</span>, <span class="st">&quot;Phytophthora megasperma cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>  <span class="co"># P. europaea cluster (clade 7a)</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora europaea&quot;</span>, <span class="st">&quot;Phytophthora europaea cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora abietivora&quot;</span>, <span class="st">&quot;Phytophthora europaea cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora uliginosa&quot;</span>, <span class="st">&quot;Phytophthora europaea cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora flexuosa&quot;</span>, <span class="st">&quot;Phytophthora europaea cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora sp. cadmea&quot;</span>, <span class="st">&quot;Phytophthora europaea cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora tyrrhenica&quot;</span>, <span class="st">&quot;Phytophthora europaea cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a>  <span class="co"># P. pisi cluster (clade 7a)</span></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora pisi&quot;</span>, <span class="st">&quot;Phytophthora pisi cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora asiatica&quot;</span>, <span class="st">&quot;Phytophthora pisi cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a>  <span class="co"># P. cryptogea complex (clade 8a)</span></span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora cryptogea&quot;</span>, <span class="st">&quot;Phytophthora cryptogea complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora pseudocryptogea&quot;</span>, <span class="st">&quot;Phytophthora cryptogea complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora erythroseptica&quot;</span>, <span class="st">&quot;Phytophthora cryptogea complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Phytophthora kelmanii&quot;</span>, <span class="st">&quot;Phytophthora cryptogea complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a>  <span class="co"># G. attrantheridium complex (clade F)</span></span>
<span id="cb5-50"><a href="#cb5-50" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium attrantheridium&quot;</span>, <span class="st">&quot;Globisporangium attrantheridium complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-51"><a href="#cb5-51" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium sp. balticum&quot;</span>, <span class="st">&quot;Globisporangium attrantheridium complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-52"><a href="#cb5-52" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Genus =</span> <span class="fu">if_else</span>(Species <span class="sc">==</span> <span class="st">&quot;Globisporangium attrantheridium complex&quot;</span>, <span class="st">&quot;Globisporangium&quot;</span>, Genus))<span class="sc">%&gt;%</span></span>
<span id="cb5-53"><a href="#cb5-53" tabindex="-1"></a>  <span class="co"># G. irregulare complex (clade F)</span></span>
<span id="cb5-54"><a href="#cb5-54" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium irregulare&quot;</span>, <span class="st">&quot;Globisporangium irregulare complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-55"><a href="#cb5-55" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium cryptoirregulare&quot;</span>, <span class="st">&quot;Globisporangium irregulare complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-56"><a href="#cb5-56" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium cylindrosporum&quot;</span>, <span class="st">&quot;Globisporangium irregulare complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-57"><a href="#cb5-57" tabindex="-1"></a>  <span class="co"># G. Sylvaticum complex (clade F)</span></span>
<span id="cb5-58"><a href="#cb5-58" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium sylvaticum&quot;</span>, <span class="st">&quot;Globisporangium sylvaticum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-59"><a href="#cb5-59" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium terrestre&quot;</span>, <span class="st">&quot;Globisporangium sylvaticum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-60"><a href="#cb5-60" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Genus =</span> <span class="fu">if_else</span>(Species <span class="sc">==</span> <span class="st">&quot;Globisporangium irregulare complex&quot;</span>, <span class="st">&quot;Globisporangium&quot;</span>, Genus))<span class="sc">%&gt;%</span></span>
<span id="cb5-61"><a href="#cb5-61" tabindex="-1"></a>  <span class="co"># G. heterothallicum complex (clade J)</span></span>
<span id="cb5-62"><a href="#cb5-62" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium heterothallicum&quot;</span>, <span class="st">&quot;Globisporangium heterothallicum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-63"><a href="#cb5-63" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium glomeratum&quot;</span>, <span class="st">&quot;Globisporangium heterothallicum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-64"><a href="#cb5-64" tabindex="-1"></a>  <span class="co"># G. megalacanthum complex (clade J)</span></span>
<span id="cb5-65"><a href="#cb5-65" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium megalacanthum&quot;</span>, <span class="st">&quot;Globisporangium megalacanthum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-66"><a href="#cb5-66" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium polymastum&quot;</span>, <span class="st">&quot;Globisporangium megalacanthum complex&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-67"><a href="#cb5-67" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Globisporangium buismaniae&quot;</span>, <span class="st">&quot;Globisporangium megalacanthum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-68"><a href="#cb5-68" tabindex="-1"></a>  <span class="co"># P. arrhenomanes cluster (clade B1)</span></span>
<span id="cb5-69"><a href="#cb5-69" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium arrhenomanes&quot;</span>, <span class="st">&quot;Pythium arrhenomanes cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-70"><a href="#cb5-70" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium aristoporum&quot;</span>, <span class="st">&quot;Pythium arrhenomanes cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-71"><a href="#cb5-71" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium phragmitis&quot;</span>, <span class="st">&quot;Pythium arrhenomanes cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-72"><a href="#cb5-72" tabindex="-1"></a>  <span class="co"># P. myriotylum complex (clade B1)</span></span>
<span id="cb5-73"><a href="#cb5-73" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium myriotylum&quot;</span>, <span class="st">&quot;Pythium myriotylum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-74"><a href="#cb5-74" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium zingiberis&quot;</span>, <span class="st">&quot;Pythium myriotylum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-75"><a href="#cb5-75" tabindex="-1"></a>  <span class="co"># P. salpingophorum complex (clade B1)</span></span>
<span id="cb5-76"><a href="#cb5-76" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium cf. salpingophorum/conidiophorum&quot;</span>, <span class="st">&quot;Pythium salpingophorum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-77"><a href="#cb5-77" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium conidiophorum&quot;</span>, <span class="st">&quot;Pythium salpingophorum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-78"><a href="#cb5-78" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium salpingophorum&quot;</span>, <span class="st">&quot;Pythium salpingophorum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-79"><a href="#cb5-79" tabindex="-1"></a>  <span class="co"># P. dissotocum complex (clade B2)</span></span>
<span id="cb5-80"><a href="#cb5-80" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium dissotocum&quot;</span>, <span class="st">&quot;Pythium dissotocum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-81"><a href="#cb5-81" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium aff. dictyosporum&quot;</span>, <span class="st">&quot;Pythium dissotocum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-82"><a href="#cb5-82" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium coloratum&quot;</span>, <span class="st">&quot;Pythium dissotocum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-83"><a href="#cb5-83" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium diclinum&quot;</span>, <span class="st">&quot;Pythium dissotocum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-84"><a href="#cb5-84" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium lutarium&quot;</span>, <span class="st">&quot;Pythium dissotocum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-85"><a href="#cb5-85" tabindex="-1"></a>  <span class="co"># P. pachycaule complex (clade B2)</span></span>
<span id="cb5-86"><a href="#cb5-86" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium pachycaule&quot;</span>, <span class="st">&quot;Pythium pachycaule complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-87"><a href="#cb5-87" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium oopapillum&quot;</span>, <span class="st">&quot;Pythium pachycaule complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-88"><a href="#cb5-88" tabindex="-1"></a>  <span class="co"># P. aquatile complex (clade B2)</span></span>
<span id="cb5-89"><a href="#cb5-89" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium aquatile&quot;</span>, <span class="st">&quot;Pythium aquatile complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-90"><a href="#cb5-90" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium sukuiense&quot;</span>, <span class="st">&quot;Pythium aquatile complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-91"><a href="#cb5-91" tabindex="-1"></a>  <span class="co"># P. minus complex (clade E2)</span></span>
<span id="cb5-92"><a href="#cb5-92" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium minus&quot;</span>, <span class="st">&quot;Pythium minus complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-93"><a href="#cb5-93" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Pythium aff. pleroticum&quot;</span>, <span class="st">&quot;Pythium minus complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-94"><a href="#cb5-94" tabindex="-1"></a>  <span class="co"># E. undulatum complex (clade H)</span></span>
<span id="cb5-95"><a href="#cb5-95" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Elongisporangium undulatum&quot;</span>, <span class="st">&quot;Elongisporangium undulatum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-96"><a href="#cb5-96" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Elongisporangium dimorphum&quot;</span>, <span class="st">&quot;Elongisporangium undulatum complex&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-97"><a href="#cb5-97" tabindex="-1"></a>  <span class="co"># Peronospora bulbocapni cluster</span></span>
<span id="cb5-98"><a href="#cb5-98" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora bulbocapni&quot;</span>, <span class="st">&quot;Peronospora bulbocapni cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-99"><a href="#cb5-99" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora dicentrae&quot;</span>, <span class="st">&quot;Peronospora bulbocapni cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-100"><a href="#cb5-100" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora chrysosplenii&quot;</span>, <span class="st">&quot;Peronospora bulbocapni cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-101"><a href="#cb5-101" tabindex="-1"></a>  <span class="co"># Peronospora ranunculi cluster</span></span>
<span id="cb5-102"><a href="#cb5-102" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora ficariae&quot;</span>, <span class="st">&quot;Peronospora ranunculi cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-103"><a href="#cb5-103" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora ranunculi&quot;</span>, <span class="st">&quot;Peronospora ranunculi cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-104"><a href="#cb5-104" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora hiemalis&quot;</span>, <span class="st">&quot;Peronospora ranunculi cluster&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-105"><a href="#cb5-105" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora illyrica&quot;</span>, <span class="st">&quot;Peronospora ranunculi cluster&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-106"><a href="#cb5-106" tabindex="-1"></a>  <span class="co"># Peronospora alpicola cluster</span></span>
<span id="cb5-107"><a href="#cb5-107" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora alpicola&quot;</span>, <span class="st">&quot;Peronospora alpicola cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-108"><a href="#cb5-108" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora pulveracea&quot;</span>, <span class="st">&quot;Peronospora alpicola cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-109"><a href="#cb5-109" tabindex="-1"></a>  <span class="co"># Peronospora corydalis cluster</span></span>
<span id="cb5-110"><a href="#cb5-110" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora corydalis&quot;</span>, <span class="st">&quot;Peronospora corydalis cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-111"><a href="#cb5-111" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora esulae&quot;</span>, <span class="st">&quot;Peronospora corydalis cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-112"><a href="#cb5-112" tabindex="-1"></a>  <span class="co"># Peronospora meconopsidis cluster</span></span>
<span id="cb5-113"><a href="#cb5-113" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora meconopsidis&quot;</span>, <span class="st">&quot;Peronospora meconopsidis cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-114"><a href="#cb5-114" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora cristata&quot;</span>, <span class="st">&quot;Peronospora meconopsidis cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-115"><a href="#cb5-115" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora apula&quot;</span>, <span class="st">&quot;Peronospora meconopsidis cluster&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-116"><a href="#cb5-116" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora argemones&quot;</span>, <span class="st">&quot;Peronospora meconopsidis cluster&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-117"><a href="#cb5-117" tabindex="-1"></a>  <span class="co"># Peronospora alsinearum cluster</span></span>
<span id="cb5-118"><a href="#cb5-118" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora alsinearum&quot;</span>, <span class="st">&quot;Peronospora alsinearum cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-119"><a href="#cb5-119" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora campestris&quot;</span>, <span class="st">&quot;Peronospora alsinearum cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-120"><a href="#cb5-120" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora paula&quot;</span>, <span class="st">&quot;Peronospora alsinearum cluster&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-121"><a href="#cb5-121" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora parva&quot;</span>, <span class="st">&quot;Peronospora alsinearum cluster&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-122"><a href="#cb5-122" tabindex="-1"></a>  <span class="co"># Peronospora effusa cluster</span></span>
<span id="cb5-123"><a href="#cb5-123" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora effusa&quot;</span>, <span class="st">&quot;Peronospora effusa cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-124"><a href="#cb5-124" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora farinosa&quot;</span>, <span class="st">&quot;Peronospora effusa cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-125"><a href="#cb5-125" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora polycarpi&quot;</span>, <span class="st">&quot;Peronospora effusa cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-126"><a href="#cb5-126" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora rumicis&quot;</span>, <span class="st">&quot;Peronospora effusa cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-127"><a href="#cb5-127" tabindex="-1"></a>  <span class="co"># Peronospora boni-henrici cluster</span></span>
<span id="cb5-128"><a href="#cb5-128" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora boni-henrici&quot;</span>, <span class="st">&quot;Peronospora boni-henrici cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-129"><a href="#cb5-129" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Peronospora minor&quot;</span>, <span class="st">&quot;Peronospora boni-henrici cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-130"><a href="#cb5-130" tabindex="-1"></a>    <span class="co"># Bremia lactucae cluster</span></span>
<span id="cb5-131"><a href="#cb5-131" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Bremia lactucae&quot;</span>, <span class="st">&quot;Bremia lactucae cluster&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb5-132"><a href="#cb5-132" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species=</span><span class="fu">str_replace</span>(Species, <span class="st">&quot;Bremia elliptica&quot;</span>, <span class="st">&quot;Bremia lactucae cluster&quot;</span>))</span></code></pre></div>
</div>
<div id="replace-taxonomy" class="section level2">
<h2>Replace taxonomy</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>phyloseq<span class="sc">::</span><span class="fu">tax_table</span>(combinedPS_clean) <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tax.cleanM)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>combinedPS_clean</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 5790 taxa and 282 samples ]
## sample_data() Sample Data:       [ 282 samples by 11 sample variables ]
## tax_table()   Taxonomy Table:    [ 5790 taxa by 7 taxonomic ranks ]
## phy_tree()    Phylogenetic Tree: [ 5790 tips and 5789 internal nodes ]</code></pre>
</div>
<div id="saving-phyloseq-objects" class="section level2">
<h2>Saving phyloseq objects</h2>
<p>Again, we save our phyloseq object into the processed_data
directory</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">saveRDS</span>(combinedPS_clean, <span class="at">file=</span> <span class="st">&quot;Processed_data/combinedPS_clean.rds&quot;</span>)</span></code></pre></div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
